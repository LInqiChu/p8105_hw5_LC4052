---
title: "p8105_hw5_LC4052"
output: github_document
date: "2025-11-05"
---

```{r}
library(tidyverse)
library(rvest)
library(patchwork)
library(dplyr)
library(ggplot2)
```

# Problem 1

## Write a function

```{r}
bday_sim = function(n_room){
  
  birthdays = sample(1:365, n_room, replace = TRUE)
  
  repeated_bday = length(unique(birthdays)) < n_room
  
  repeated_bday

}

```

## Simulation

```{r}
bday_sim_results = 
  expand_grid(
    bdays = 2:50,
    iter = 1:10000
  ) |>
  mutate(
    result = map_lgl(bdays, bday_sim)
  ) |>
  group_by(
    bdays
  ) |>
  summarize(
    prob_repeat = mean(result)
  )

```

## Make a plot

```{r}
bday_sim_results |>
  ggplot(aes(x = bdays, y = prob_repeat)) +
  geom_point() +
  geom_line() +
  labs(
    title = "Birthday Simulation Results",
    subtitle = "Probability of at least two people sharing a birthday vs. group size",
    x = "Group Size (number of people)",
    y = "Probability",
    caption = "Based on 10,000 simulations per group size"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5)
  ) 

```
When group size is 23, the probability that at least two people share a birthday is approximately 50%. When group size is 50, the probability approaches 100%.

## 


